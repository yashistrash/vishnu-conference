<?xml version="1.0" encoding="UTF-8"?>
<diagram name="hysteresis_control">
    <![CDATA[
╔═══════════════════════════════════════════════════════════════════════════╗
║              HYSTERESIS CONTROL: DUAL-THRESHOLD ALGORITHM                 ║
╚═══════════════════════════════════════════════════════════════════════════╝


                        HYSTERESIS CONTROL BLOCK
    ┌─────────────────────────────────────────────────────────────┐
    │                                                             │
    │                     ┌────────────────┐                      │
    │                     │  Soil Moisture │                      │
    │                     │   Sensor (M)   │                      │
    │                     └────────┬───────┘                      │
    │                              │                              │
    │                              ▼                              │
    │            ┌─────────────────────────────────┐              │
    │            │   Moisture Value M(t)           │              │
    │            └─────────┬───────────────────────┘              │
    │                      │                                      │
    │       ┌──────────────┼──────────────┐                       │
    │       │              │              │                       │
    │       ▼              ▼              ▼                       │
    │  ┌────────┐    ┌─────────┐    ┌────────┐                   │
    │  │ M < 30%│    │30%≤M≤60%│    │ M > 60%│                   │
    │  └───┬────┘    └────┬────┘    └────┬───┘                   │
    │      │              │              │                       │
    │      ▼              ▼              ▼                       │
    │  ┌────────┐    ┌─────────┐    ┌────────┐                   │
    │  │Pump=ON │    │Pump=HOLD│    │Pump=OFF│                   │
    │  └───┬────┘    └────┬────┘    └────┬───┘                   │
    │      │              │              │                       │
    │      └──────────────┼──────────────┘                       │
    │                     │                                      │
    │                     ▼                                      │
    │           ┌──────────────────┐                             │
    │           │  Pump State P(t) │                             │
    │           └──────────────────┘                             │
    │                                                            │
    └────────────────────────────────────────────────────────────┘


                      STATE TRANSITION DIAGRAM
    ┌─────────────────────────────────────────────────────────────┐
    │                                                             │
    │         Moisture > 60%                                      │
    │    ┌───────────────────────────────┐                        │
    │    │                               │                        │
    │    │                               ▼                        │
    │ ┌──┴──────┐   30% ≤ M ≤ 60%   ┌─────────┐                  │
    │ │  PUMP   │◄──────────────────│  PUMP   │                  │
    │ │  OFF    │                   │   OFF   │                  │
    │ │ (State  │                   │ (State  │                  │
    │ │   0)    │                   │   0)    │                  │
    │ └──┬──────┘                   └─────────┘                  │
    │    │                              ▲                        │
    │    │ Moisture < 30%               │                        │
    │    │                              │                        │
    │    ▼                              │                        │
    │ ┌─────────┐   30% ≤ M ≤ 60%   ┌──┴──────┐                  │
    │ │  PUMP   │──────────────────►│  PUMP   │                  │
    │ │  ON     │                   │   ON    │                  │
    │ │ (State  │                   │ (State  │                  │
    │ │   1)    │                   │   1)    │                  │
    │ └─────────┘                   └─────────┘                  │
    │    ▲                              │                        │
    │    │                              │                        │
    │    └──────────────────────────────┘                        │
    │         Moisture < 30%                                     │
    │                                                            │
    └────────────────────────────────────────────────────────────┘


                    DECISION PRIORITY HIERARCHY
    ┌─────────────────────────────────────────────────────────────┐
    │                                                             │
    │  ┌────────────────────────────────────────────────┐         │
    │  │      PRIORITY 1: Rain Override                 │         │
    │  │   IF (Rain == DETECTED) → Pump = OFF           │         │
    │  └──────────────────┬─────────────────────────────┘         │
    │                     │                                       │
    │                     ▼ No Rain                               │
    │  ┌────────────────────────────────────────────────┐         │
    │  │      PRIORITY 2: Hysteresis Control            │         │
    │  │   IF (M < 30%)   → Pump = ON                   │         │
    │  │   IF (M > 60%)   → Pump = OFF                  │         │
    │  │   IF (30%≤M≤60%) → Pump = HOLD                 │         │
    │  └──────────────────┬─────────────────────────────┘         │
    │                     │                                       │
    │                     ▼                                       │
    │  ┌────────────────────────────────────────────────┐         │
    │  │      PRIORITY 3: Warning Indicators            │         │
    │  │   IF (pH out of 5.5-7.5)  → Yellow LED         │         │
    │  │   IF (Temp > 35°C)        → Yellow LED         │         │
    │  └────────────────────────────────────────────────┘         │
    │                                                             │
    └─────────────────────────────────────────────────────────────┘
    ]]>
</diagram>
